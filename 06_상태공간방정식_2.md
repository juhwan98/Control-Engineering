# 상태공간방정식   
광운대학교 전기공학과 2018732062 박주환 

---  
## P3.1


---
## p3.3
---
## p3.5

그림 P3.5에 폐루프 제어시스템이 주어져 있다. (a) 폐루프 전달함수 $T(s) = Y(s)/R(s)$를 구하라. (b) 상태변수 모델을 구하하.

## 풀이
(a)  
먼저 직렬연결된 전달함수들을 곱하여 계산하자.
  s^3 + 5 s^2 - 23 s + 2
  
$$
G(s) = \frac{s+2}{s+8}\frac{1}{s-3}\frac{1}{s} = \frac{s+2}{s^3+5s^2-24s}
$$

폐루프 전달함수를 구하기 위하여 다음식에 위 식을 대입하자.

$$
\frac{G(s)}{1+G(s)} =  \frac{s+2}{s^3+5s^2-23s+2}
$$

$\therefore T(s) = \frac{s+2}{s^3+5s^2-23s+2}$

(b)  
분자와 분모에 상태변수의 라플라스변환인 $X(s)$를 곱하여 $Y(s)$와 $R(s)$를 X(s)에 대하여 표현하자.

$$
\frac{Y(s)}{R(s)} = \frac{(s+2)X(s)}{(s^3+5s^2-23s+2)X(s)}  
$$

$$
Y(s) = sX(s) + 2X(s)
$$

$$
R(s) = s^3X(s) + 5s^2X(s) - 23sX(s) +2X(s)
$$

위 두식을 역라플라스변환을 하여 상태변수 $x_1(x(t)),x_2(\dot{x}(t),x_3(\ddot{x}(t)$에 대하여 정리하자

$$
y(t) = \frac{dx}{dt} + 2x = x_2(t) + 2X_1(t)
$$

$$
r(t) = \frac{d^3x}{dt^3} + 5\frac{d^2x}{dt^2} - 23\frac{dx}{dt} + 2x = \dot{X_3}(t) + 5x_3(t) - 23x_2(t) +2x_1(t)
$$

$$
\mathbf{\dot{x}(t)} = \begin{bmatrix}
0 & 1 & 0\\ 
0 & 0 & 1\\ 
-1 & 23 & -5
\end{bmatrix}\mathbf{x}(t) + \begin{bmatrix}
0\\ 
0\\ 
1
\end{bmatrix}r(t)
$$

$$
y(t) = \begin{bmatrix}
2 & 1 & 0
\end{bmatrix}\mathbf{x}(t)
$$

---
## p3.12

전달함수가

$$\frac{Y(s)}{R(s)} = T(s) = \frac{8(s+5)}{s^3+12s^2+44s+48}$$

인 시스템에서 (a) 상태공간모델을 구하라. (b) 상태천이행렬 $\mathbf{\Phi}(t)$를 구하라.


### 풀이
(a)

$$
\mathbf{\dot{x}(t)} = \begin{bmatrix}
0 & 1 & 0\\ 
0 & 0 & 1\\ 
-48 & -44 & -12
\end{bmatrix}\mathbf{x}(t) + \begin{bmatrix}
0\\ 
0\\ 
1
\end{bmatrix}r(t)
$$

$$
y(t) = \begin{bmatrix}
40 & 8 & 0
\end{bmatrix}\mathbf{x}(t)
$$

(b)  
위 시스템행렬A를 이용하여 상태천이행렬을 구할 수 있다. 다음 매트랩기능을 이용하여 3x3역행렬을 구하고 역라플라스변환을 하여 구하는 코드를 작성하였다.  

```
>> syms s
>> I = eye(3);
>> A = [0 1 0;0 0 1;-48 -44 -12];
>> Phi_s = inv(s*I - A);
>> Phi_t = ilaplace(Phi_s);
>> Phi_t 
Phi_t =
 
[     3*exp(-2*t) - 3*exp(-4*t) + exp(-6*t), (5*exp(-2*t))/4 - 2*exp(-4*t) + (3*exp(-6*t))/4,     exp(-2*t)/8 - exp(-4*t)/4 + exp(-6*t)/8]
[  12*exp(-4*t) - 6*exp(-2*t) - 6*exp(-6*t), 8*exp(-4*t) - (5*exp(-2*t))/2 - (9*exp(-6*t))/2,   exp(-4*t) - exp(-2*t)/4 - (3*exp(-6*t))/4]
[12*exp(-2*t) - 48*exp(-4*t) + 36*exp(-6*t),       5*exp(-2*t) - 32*exp(-4*t) + 27*exp(-6*t), exp(-2*t)/2 - 4*exp(-4*t) + (9*exp(-6*t))/2]
```

---
## p3.17

다음과 같은 상태변수 방정식으로 표현된 시스템이 있다.

$$
\mathbf{\dot{x}(t)} = \begin{bmatrix}
1 & 1 & -1\\ 
4 & 3 & 0\\ 
-2 & 1 & 10
\end{bmatrix}\mathbf{x}(t) + \begin{bmatrix}
0\\ 
0\\ 
4
\end{bmatrix}u(t)
$$

$$
y(t) = \begin{bmatrix}
1 & 0 & 0
\end{bmatrix}\mathbf{x}(t)
$$

$G(s) = Y(s)/U(s)$를 구하라.


### 풀이

상태미분방정식을 전개하면 다음과 같다.

$$\dot{x}_1(t) = x_1(t) + x_2(t) - x_3(t) ...(1)$$

$$\dot{x}_2(t) = 4x_1(t) + 3x_2(t) ...(2)$$

$$\dot{x}_3(t) = -2x_1(t) + 1x_2(t) + 10x_3(t) + 4u(t) ...(3)$$

식 (1)과 식(2)를 통해 다음 등식이 성립한다.

$$x_2(t) = -x_1(t)$$

$$x_3(t) = x_1(t)$$

위 $x_2(t)와 x_3(t)$를 식(3)에 대입하여 $u(t)를 x(t)$에 대하여 정리하자.

$$\mathbf{\dot{x}_3(t)} = 7x_1(t) + 4u(t)$$

위 정리된 식과 출력방정식을 라플라스 변환하자.

$$U(s) = \frac{s^3-7}{4}X(s)$$

$$Y(s) = X(s)$$

$\therefore G(s) = \frac{Y(s)}{U(s)} = \frac{4}{s^3-7}$
